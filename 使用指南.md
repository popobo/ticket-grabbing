# 抢票项目使用指南

## 项目概述

这是一个基于 AutoX.js 的自动化抢票项目，支持多个票务平台的抢票功能。项目包含前端自动化脚本和后端通知服务，旨在通过技术手段提高抢票成功率。

### 支持的平台
- **猫眼** - 支持卡点抢票和余票监控
- **纷玩岛** - 支持卡点抢票，适合演唱会等长周期抢票
- **大麦** - 计划中，将支持主动通知功能

## 环境准备

### 1. 基础环境
- **操作系统**: Android 系统
- **核心工具**: AutoX.js (版本 6.5.8)
- **下载地址**: https://github.com/kkevsekk1/AutoX/releases/tag/6.5.8

### 2. 安装步骤
1. 下载并安装 AutoX.js APK
2. 开启无障碍服务权限
3. 安装对应票务平台 APP（猫眼、纷玩岛等）
4. 在票务平台完成实名认证和观演人信息填写

### 3. 后端服务（可选）
如需使用邮件通知功能，需要部署 Java 后端服务：
- 运行 `ticket-notice` 目录下的 Spring Boot 项目
- 配置邮件服务参数
- 设置 API 密钥

## 脚本功能详解

### 1. 猫眼抢票脚本

#### MaoYanGoNew.js - 卡点抢票
**适用场景**: 已知开票时间，需要精确卡点抢票

**使用步骤**:
1. 在猫眼 APP 中完成预约和预填信息
2. 打开 AutoX.js，运行 `MaoYanGoNew.js`
3. 脚本会自动等待开票时间
4. 开票后自动点击抢票按钮并完成支付

**配置参数**:
```javascript
// 确认按钮坐标（建议配置）
const ConfirmX = 878;
const ConfirmY = 2263;

// 调试模式开关
var isDebug = false;
```

#### MaoYanMonitor.js - 余票监控
**适用场景**: 监控特定票价范围内的余票，发现合适票档自动抢票

**使用步骤**:
1. 运行脚本，输入监控参数：
   - 场次关键字（如：05-18,05-19）
   - 最高票价限制（如：800）
   - 观演人姓名（多个用逗号分隔）
2. 脚本会持续监控票档变化
3. 发现符合条件的票档自动抢票

**配置参数**:
```javascript
// 监控刷新间隔（秒）
const monitorIntervalSeconds = 2;

// WebHook 通知地址
const webHookNoticeUrl = "";

// 是否响铃提醒
const isRingingBell = true;

// 默认参数（可选）
var defaultPlayEtcStr;    // 默认场次
var defaultMaxTicketPrice; // 默认最高票价
var defaultViewers;       // 默认观演人
```

**高级功能**:
- 自动刷新按钮点击
- 观演人自动选择
- WebHook 通知
- 响铃提醒
- 无需配置绝对坐标，更加通用

### 2. 纷玩岛抢票脚本

#### FenWanDaoGo.js - 卡点抢票
**适用场景**: 纷玩岛平台的演唱会等长周期抢票

**特点**: 
- 纷玩岛抢票周期较长，不会秒空
- 比拼耐性，更适合脚本自动化
- 实测晚10分钟仍能成功抢到票

**使用步骤**:
1. 在纷玩岛 APP 中完成预约和预填信息
2. 运行脚本，输入抢票时间（格式：04-21 16:18）
3. 脚本会精确卡点进入抢票流程
4. 自动完成票档选择和支付

**配置参数**:
```javascript
// 确认按钮坐标
const ConfirmX = 878;
const ConfirmY = 2263;

// 调试模式
var isDebug = false;
```

## 使用流程

### 准备工作
1. **实名认证**: 在对应票务平台完成实名认证
2. **观演人设置**: 添加观演人信息
3. **支付方式**: 绑定支付方式
4. **预约信息**: 完成抢票预约和预填信息

### 抢票流程

#### 卡点抢票流程
1. 确认开票时间
2. 提前5-10分钟启动对应脚本
3. 脚本自动等待开票时间
4. 开票后自动执行抢票流程
5. 完成支付确认

#### 余票监控流程
1. 设置监控参数（场次、票价、观演人）
2. 启动监控脚本
3. 脚本持续监控票档变化
4. 发现合适票档自动抢票
5. 收到通知后确认支付

### 调试模式
所有脚本都支持调试模式，开启后：
- 不会点击支付按钮，避免生成过多订单
- 可以测试抢票流程的准确性
- 建议正式使用前先进行调试

## 通知功能

### 邮件通知
通过后端服务发送邮件通知：

**API 接口**:
```
POST /notice/email
Content-Type: application/json
Authentication: [API密钥]

{
  "addr": "邮箱地址",
  "title": "通知标题", 
  "content": "通知内容"
}
```

### WebHook 通知
在监控脚本中配置 WebHook 地址，抢票成功时自动发送通知。

### 响铃提醒
脚本内置响铃功能，抢票成功时播放提示音。

## 常见问题解决

### 1. 余票监控无反应
**问题**: 启动后没有检测到票档变化

**解决方案**:
- 检查是否在正确的票档界面
- 手动点击一次"缺货登记"按钮刷新 DOM
- 确认监控参数设置正确

### 2. 点击失败
**问题**: 脚本无法正确点击按钮

**解决方案**:
- 配置正确的按钮坐标
- 检查无障碍服务是否开启
- 确认 APP 界面元素是否发生变化

### 3. 时间同步问题
**问题**: 卡点时间不准确

**解决方案**:
- 脚本已内置45ms网络延迟补偿
- 建议使用网络时间同步
- 提前启动脚本确保时间同步

## 注意事项

### 法律声明
- 本项目仅用于学习和个人使用
- 请支持官方渠道，抵制黄牛囤票
- 脚本仅模拟人工操作，提升购票效率

### 使用建议
1. **提前测试**: 正式使用前先进行调试测试
2. **参数配置**: 根据实际情况调整坐标和参数
3. **网络环境**: 确保网络稳定，避免延迟影响
4. **设备性能**: 使用性能较好的设备运行脚本
5. **多设备备用**: 建议准备多个设备同时运行

### 技术限制
- 仅支持 Android 平台
- 需要 AutoX.js 环境
- 依赖无障碍服务权限
- 界面变化可能导致脚本失效

## 更新日志

### 当前版本功能
- ✅ 猫眼卡点抢票
- ✅ 猫眼余票监控
- ✅ 纷玩岛卡点抢票
- ✅ 自动观演人选择
- ✅ 自动刷新功能
- ✅ WebHook 通知
- ✅ 响铃提醒
- 🔄 大麦平台支持（开发中）

### 计划功能
- 大麦平台抢票支持
- 更多票务平台支持
- 智能票档选择
- 多账号并发抢票
- 更精确的时间同步

## 技术支持

如有问题或建议，欢迎通过以下方式联系：
- GitHub Issues
- 项目讨论区

---

**免责声明**: 本项目仅供学习和个人使用，使用者需自行承担使用风险，开发者不承担任何法律责任。 