# 项目结构说明

## 目录结构

```
ticket-grabbing/
├── README.md                    # 项目主文档
├── 使用指南.md                  # 详细使用指南
├── 快速开始.md                  # 快速开始指南
├── 脚本配置参考.md              # 配置参数详解
├── 项目结构说明.md              # 本文档
├── LICENSE                      # 开源协议
├── CLAUDE.md                    # 项目说明
│
├── MaoYan/                      # 猫眼抢票脚本
│   ├── MaoYanGoNew.js          # 卡点抢票脚本
│   ├── MaoYanGo.js             # 旧版抢票脚本
│   ├── MaoYanDraft.js          # 草稿版本
│   └── MaoYanMonitor.js        # 余票监控脚本
│
├── FenWanDao/                   # 纷玩岛抢票脚本
│   └── FenWanDaoGo.js          # 卡点抢票脚本
│
├── PiaoXingQiu/                # 票星球脚本（待开发）
│   └── PiaoXingQiuGo.js        # 抢票脚本
│
├── Test/                        # 测试脚本
│   └── Test.js                  # 测试用脚本
│
└── ticket-notice/               # 后端通知服务
    ├── pom.xml                  # Maven 配置文件
    ├── src/
    │   ├── main/
    │   │   ├── java/
    │   │   │   └── com/dsy/ticketnotice/
    │   │   │       ├── config/              # 配置类
    │   │   │       │   ├── ApiKeyInterceptor.java
    │   │   │       │   ├── GlobalExceptionHandler.java
    │   │   │       │   ├── SecurityProperties.java
    │   │   │       │   └── WebConfig.java
    │   │   │       ├── controller/          # 控制器
    │   │   │       │   └── NoticeController.java
    │   │   │       ├── model/               # 数据模型
    │   │   │       │   ├── EmailParam.java
    │   │   │       │   └── ResultModel.java
    │   │   │       ├── service/             # 服务层
    │   │   │       │   └── EmailService.java
    │   │   │       └── TicketNoticeApplication.java
    │   │   └── resources/                   # 资源文件
    │   │       ├── application.yml          # 主配置文件
    │   │       ├── application-dev.properties
    │   │       ├── application-prod.properties
    │   │       ├── logback-dev.xml
    │   │       ├── logback-prod.xml
    │   │       └── script/                  # 脚本资源
    │   │           ├── DaMaiMonitor.js
    │   │           ├── test.js
    │   │           └── ticket-notice.postman_collection.json
    │   └── test/                            # 测试代码
    │       └── java/com/dsy/ticketnotice/
    │           └── TicketNoticeApplicationTests.java
    └── README.md
```

## 脚本功能说明

### 猫眼平台脚本

#### MaoYanGoNew.js
- **功能**: 卡点抢票
- **适用场景**: 已知开票时间，需要精确卡点
- **特点**: 
  - 自动检测预约状态
  - 精确时间同步
  - 自动刷新按钮点击
  - 支持调试模式

#### MaoYanMonitor.js
- **功能**: 余票监控
- **适用场景**: 监控特定票价范围内的余票
- **特点**:
  - 智能票档识别
  - 观演人自动选择
  - WebHook 通知
  - 响铃提醒
  - 无需配置绝对坐标

#### MaoYanGo.js
- **功能**: 旧版抢票脚本
- **状态**: 已废弃，建议使用 MaoYanGoNew.js

#### MaoYanDraft.js
- **功能**: 草稿版本
- **状态**: 开发中，不建议使用

### 纷玩岛平台脚本

#### FenWanDaoGo.js
- **功能**: 卡点抢票
- **适用场景**: 演唱会等长周期抢票
- **特点**:
  - 适合纷玩岛平台特点
  - 长周期抢票优势明显
  - 实测晚10分钟仍能成功

### 票星球平台脚本

#### PiaoXingQiuGo.js
- **功能**: 抢票脚本
- **状态**: 待开发

### 测试脚本

#### Test.js
- **功能**: 测试用脚本
- **用途**: 调试和测试功能

## 后端服务结构

### 核心组件

#### 配置层 (config/)
- **ApiKeyInterceptor.java**: API 密钥拦截器
- **GlobalExceptionHandler.java**: 全局异常处理
- **SecurityProperties.java**: 安全配置属性
- **WebConfig.java**: Web 配置

#### 控制器层 (controller/)
- **NoticeController.java**: 通知控制器
  - 邮件通知接口
  - 错误测试接口

#### 模型层 (model/)
- **EmailParam.java**: 邮件参数模型
- **ResultModel.java**: 统一返回结果模型

#### 服务层 (service/)
- **EmailService.java**: 邮件服务
  - 发送简单邮件
  - 邮件配置管理

### 配置文件

#### 主配置文件
- **application.yml**: 主配置文件
- **application-dev.properties**: 开发环境配置
- **application-prod.properties**: 生产环境配置

#### 日志配置
- **logback-dev.xml**: 开发环境日志配置
- **logback-prod.xml**: 生产环境日志配置

### API 接口

#### 邮件通知接口
```
POST /notice/email
Content-Type: application/json
Authentication: [API密钥]

请求体:
{
  "addr": "邮箱地址",
  "title": "通知标题",
  "content": "通知内容"
}
```

#### 错误测试接口
```
GET /notice/errorTest
```

## 开发规范

### 脚本开发规范
1. **命名规范**: 平台名 + 功能名 + 版本标识
2. **注释规范**: 关键功能必须有中文注释
3. **配置规范**: 可配置参数放在文件开头
4. **调试规范**: 必须支持调试模式

### 后端开发规范
1. **包结构**: 按功能模块分包
2. **命名规范**: 使用驼峰命名法
3. **异常处理**: 统一异常处理机制
4. **配置管理**: 环境分离配置

## 部署说明

### 前端脚本部署
1. 安装 AutoX.js
2. 导入脚本文件
3. 配置参数
4. 测试运行

### 后端服务部署
1. 安装 Java 环境
2. 配置 Maven
3. 修改配置文件
4. 启动服务

## 版本管理

### 脚本版本
- **v1.0**: 基础抢票功能
- **v1.1**: 添加监控功能
- **v1.2**: 优化通知系统
- **v1.3**: 添加纷玩岛支持

### 后端版本
- **v1.0**: 基础邮件通知
- **v1.1**: 添加 API 密钥验证
- **v1.2**: 优化异常处理

## 贡献指南

### 代码贡献
1. Fork 项目
2. 创建功能分支
3. 提交代码
4. 创建 Pull Request

### 文档贡献
1. 完善使用文档
2. 添加配置说明
3. 更新常见问题

### 测试贡献
1. 测试脚本功能
2. 报告 Bug
3. 提供改进建议

---

**注意**: 本项目仅供学习和个人使用，请遵守相关法律法规。 